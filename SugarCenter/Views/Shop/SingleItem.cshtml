@using System.IO
@using SugaringCentreAuckland.Persistent.SugaringCentreAucklandElk.Models
@model SugaringCentreAuckland.Persistent.SugaringCentreAucklandElk.Models.ShopItem
@{
    Layout = null;
}
<link href="@Url.Content("~/css/SingleItem.css")" rel="stylesheet" type="text/css" />

<div class="main">
    <section class="module">
        <div class="container">
            <div class="grid second-nav">
                <div class="column-xs-12">
                    <nav>
                        <ol class="breadcrumb-list">
                            <li class="breadcrumb-item">
                                <a asp-area="" asp-controller="Shop" asp-action="Shop">Shop</a>
                            </li>
                            <li class="breadcrumb-item"><a href="#">@Model.NavigationShopCategoryId.Name</a></li>
                            <li class="breadcrumb-item active">@Model.Name</li>
                        </ol>
                    </nav>
                </div>
            </div>
            <div class="grid product">
                <div class="column-xs-12 column-md-7">
                    <div class="product-gallery">
                        <div class="product-image">
                            <img class="active" src="https://source.unsplash.com/W1yjvf5idqA">
                        </div>
                        <ul class="image-list">
                            <li class="image-item"><img src="https://source.unsplash.com/W1yjvf5idqA"></li>
                            <li class="image-item"><img src="https://source.unsplash.com/W1yjvf5idqA"></li>
                            <li class="image-item"><img src="https://source.unsplash.com/VgbUxvW3gS4"></li>
                            <li class="image-item"><img src="https://source.unsplash.com/5WbYFH0kf_8"></li>
                        </ul>
                    </div>
                </div>
                <div class="column-xs-12 column-md-5">
                    <h1>@Model.Name</h1>
                    <h2>$@Model.Price</h2>
                    <div class="description">
                        @Model.Desc
                    </div>
                    <button class="add-to-cart">Add To Cart</button>
                </div>
            </div>
            <div class="grid related-products">
                <div class="column-xs-12">
                    <h3>You may also like</h3>
                </div>
                @for (int i = 0; i < 3; i++)
                {
                    Random rnd = new Random();
                    ShopItem tmp = Model.NavigationShopCategoryId.ShopItems.ElementAt(rnd.Next(Model.NavigationShopCategoryId.ShopItems.Count));
                    var thumbImg = Convert.ToBase64String(tmp.ProductImg);
                    
                    <div class="column-xs-12 column-md-4">
                        <img src="data:image/jpeg;base64,@thumbImg">
                        <h4>@tmp.Name</h4>
                        <p class="price">$@tmp.Price</p>
                    </div>
                }
            </div>
        </div>
    </section>
    <hr class="divider-w">
</div>

<script>
    const activeImage = document.querySelector(".product-image .active");
    const productImages = document.querySelectorAll(".image-list img");
    const navItem = document.querySelector('a.toggle-nav');

    function changeImage(e) {
        activeImage.src = e.target.src;
    }

    function toggleNavigation(){
        this.nextElementSibling.classList.toggle('active');
    }

    productImages.forEach(image => image.addEventListener("click", changeImage));
    navItem.addEventListener('click', toggleNavigation);
</script>
